---
title: '四维空间（十五）：平面状态空间与夹角问题（下）'
tags:
  - 四维
  - 几何
  - 系列文章
  - 数学
categories: 四维空间系列
---
<div style="float:right"><img src="/img/angle001.svg" style="width:100%;max-width:380px" alt="平面状态空间中的几个同构的几何意义"/></div>

## 内容概要

- 旋转作用于状态空间
- 状态空间中表示直线
- 面胞夹角范围模拟器
- 上期文末思考题答案

<!--more-->

## 旋转作用于状态空间

我们知道2-向量是可以生成旋转的，旋转反过来又可以作用在单位平面或2-向量上，这说明旋转变换对应着平面状态空间内部的一个变换。我们定义自对偶2-向量生成的等角旋转叫左手旋转，反自对偶生成的则是右手旋转。在几何代数中可以用指数映射计算旋转变换，计算中自对偶2-向量跟反自对偶2-向量相乘是完全可交换顺序的，指数映射本质就是乘法与加法构成的幂级数，也可以交换顺序，因此它们互不干扰，因此左等角旋转只作用在自对偶分量上，右等角旋转只作用在反自对偶分量上：
$$R_LR_R(F^++F^-)R'_LR'_R=R_LR_R(F^+)R'_LR'_R+R_LR_R(F^-)R'_LR'_R$$$$=R_L(F^+)R'_LR_RR'_R+R_LR'_LR_R(F^-)R'_R=R_L(F^+)R'_L+R_R(F^-)R'_R$$
由于能表示平面的简单2-向量是两个大小相等的自对偶、反自对偶2-向量之和，根据生成元与旋转间的指数映射可知，简单旋转是两个转速相同的左右等角旋转的组合。举一个例子：绕xy平面旋转90度的这个旋转变换，它保持xy、zw平面不变，因此只可能是刚好以两个球面上xy、zw平面相应的点为轴的旋转。我们可以验算：该旋转把yz平面旋转到xz平面的位置、把xw平面旋转到yw的位置，其状态空间确实做了相应的旋转变换。

通过旋转在状态空间中的变换规律，我们还能得出关于Hopf纤维丛的一些对称性结论。右手（或左手）Hopf纤维丛中圆周所在的平面其实就是与某一平面右手（或左手）等角的所有平面的集合，我们称其为右手（或左手）等角平面簇。对于右手等角平面簇，它在任意左手等角旋转下会保持不变，且会将簇中的平面旋转到同在簇中的其它平面的位置上；它只在某特殊的右手等角旋转下才保持不变，这些旋转会保持簇中所有平面不动，即只能沿着纤维丛圆周的方向旋转。换句话说就是，右手等角旋转的产生的轨道圆周都夹右手等角，左手等角旋转的轨道圆周都夹左手等角。为什么是相同的呢？其实这没有更深刻的含义，仅仅是定义问题：我**故意选取平面之间的左手右手关系与左右手旋转的轨迹间手性保持一致，同理左右手旋转也故意选取跟四元数左右乘对应的旋转保持一致**。交换左右的定义也完全没问题，只是结论没有这么整齐。

<span class="likecode">（注：我发现我之前的文章中关于左右手旋转的定义是乱的，趁次机会我已将旧文中的说法都统一了）</span>

### 旋转平面

对四维所有平面空间（即S2XS2）执行旋转，若是等角双旋转，则只转动一个球面，若是简单旋转，则两个球面旋转角速度相同。且对于非等角旋转，两个球面都会转动，转轴交两球面有四个点，它们刚好能表示出绝对垂直的旋转平面对。对于简单旋转，绝对垂直的旋转平面对又一个才真的在旋转，另一个则是静止的，如何区分它们呢？答案是通过旋转方向来辨别：

注：这些顺时针逆时针也不是根深蒂固的，它跟我们建立的自对偶/反自对偶空间坐标系的三个轴的定向有关，如果交换两个轴导致空间手性变化，则结论也会相反。

## 平面与直线、三维胞的夹角问题

在四维，求夹角范围的问题其实还有这些情况：
1. 已知A、B两平面夹角为$\alpha_1$和$\alpha_2$，B与胞C的夹角为$\beta$，求A、C之间的面胞角$\gamma$的取值范围。
1. 已知平面A与平面B分别与胞C夹角为$\alpha$和$\beta$，求A、B平面之间的两夹角$\gamma_1$与$\gamma_2$的取值范围。

我们不再关注三维空间直线与平面夹角范围问题，因为能等价转化为直线与平面的法线夹角的问题(其答案角度互余)，四维空间中平面与直线、直线与胞夹角等问题同理。

为了解决这些问题，我们必须找到在平面状态空间中（也就是那两个球面）表示胞或其法向量的方法。胞的法向量是四维空间中的单位向量，其所有集合构成超球面$\mathbb{S}^3$，完全无法融入两个球面空间$\mathbb{S}^2\times \mathbb{S}^2$中，让我们回想直线与平面的夹角计算公式：求单位向量与单位2-向量的外积，得到一个3-向量，其大小为夹角的正弦值。我一番尝试后发现，外积的计算公式没办法在平面状态空间中直接表示出来。这时我们有两个选择：一是放弃对偶分解，回到最普通的6个坐标面基底硬着头皮计算，二是放弃直接表示直线，看能不能有其它间接的方法。第一种不说了，计算夹角范围会陷入冗长的计算，第二种方案，我想到了使用平面交线来表示直线。

### 直线的表示

如果两平面有交线则说明它们半平行。所有过某直线的平面，它们都该两两半平行，形成半平行平面簇。由于半平行的两平面在两边的球面距离是相等的，我自然就联想到：**自对偶与反自对偶球面之间的每个保持球面距离的对应关系都给出了一簇半平行平面簇**。这个半平行平面簇应该是最大的了，因为我已经让两边球面上所有点都参与了，已经没有加入其它平面的点且仍然保持两两半平行的方式了。

每个保持球面距离的对应关系在数学术语中叫做**等距同构**，球面之间的所有等距同构很明显对应正交群O(3)，即球面上所有的旋转与反射变换。这是否说明每个旋转旋转与反射变换都对应一条四维空间中过原点的直线呢？特别是反射变换显得很不自然：旋转变换是连续变换，四维直线的状态空间（超球面）也是连续的，不需要反射变换，说明该对应关系不成立。

其实半平行平面簇除了都共线的情况，还有另一种可能就是都共胞，这个情况下包含了一个三维胞中的所有平面。虽然它们的交线不唯一，但它确定了这个胞，也就确定了法向量。我们看到，半平行平面簇也不完美，它也出现了两种截然不同的模式：一种是共线模式，另一种是共胞模式。正交群O(3)中包含反射变换，我们根据变换是否有翻转定向可将群分成两个部分（也叫[陪集]()），第一个部分是纯旋转，第二个部分是加入了一次反射的旋转。我们希望这两部分跟两种半平行平面簇刚好能对应起来。事实的确如此：共线模式的平面簇的法平面（即绝对垂直）构成的簇就是共胞模式，二绝对垂直就是保持一个球面不动，另一个球面中心反演到其对径点的操作，三维空间中的中心反演正好将其手性（定向）改变了，至此所有线索都联系起来了。

纯旋转跟带反射的旋转到底哪个对应共线模式、哪个对应共胞模式呢？这也取决于坐标系的选取。自对偶分量与反自对偶分量就像是两个完全独立的世界，它们之间没有任何特别的对应关系，没有参照物比较也无法界定两边空间的手性（定向）是否一致。如果按下图选择坐标系，则这样的直接对应表示的是x轴。

最后还有一个巧妙的事实：把三维球面$\mathbb S ^3$上的对径点等同后的空间就是三维空间中的所有旋转$SO(3)$组成的拓扑空间。常规的证明用的是四元数表示三维旋转的公式。现在我们又多了一个理解它的方式：三维球面$\mathbb S ^3$上的对径点等同后的空间就代表所有四维空间中过原点的直线。共胞与共线模式我们选一种就够了，因此可以确定一种定向后只考虑旋转映射，即球面上的每个旋转都唯一对应四维空间中的一条过原点直线。

### 平面与直线的夹角

下一步就是如何表示直线与平面的夹角。现在直线被定义成了自对偶跟反自对偶球面之间的等距同构映射。我们很自然地想到可以通过该映射将一平面的两个分量拉到同一球面上来比较距离。这个球面距离是否就对应线面角呢？这样做其实是把在所有平行于该直线的平面中跟另一平面等角的那张拎出来了，根据等角平面的定义，该平面上所有直线都与另一平面夹等角，这个角度明显就是要求的线面角。但要注意的是球面距离是两角的和差，其绝对值一定是线面角的两倍，因此答案是**这个球面距离的一半才是待求的线面角**。利用此原理，我们终于可精确解决三维胞中的所有平面跟另一平面的夹角范围。

### 问题1的求解
### 问题2的求解

### 上篇文章的思考题

这些平面与超球相交是圆周。圆周之间会相交吗？若有，是几个圆周交于一点呢？一个圆周上有多少个点与其它圆周相交呢？
首先是两边都取正八面体：由于正八面体有6个顶点，排列组合得到$6\times 6=36$个2-向量。但这里面有一半的向量方向跟另一半相反，因此最终表示的平面只有18个。首先两边都是球面上取的正八面体顶点，取任意两个顶点都能随便各自选正八面体的一条边找到另外点，因此每个圆周都会与其它圆周相交。当固定一个交点后（即固定了左右两正八面体中两顶点的对应关系），其它顶点的对应关系也就随之确定，这说明有6个2-向量再次相交，其中一半的定向相反，最终得到3个圆周相交于1点，且两两相交的角度都是90°。一个圆周上的交点数量如何确定呢？我们可以沿该圆周做旋转，发现有旋转90°的对称性，因此每个圆周上有4个交点。

![正四面体-正八面体：24个圆周](/img/angle001.jpg)
![正十二面体-正二十面体：120个圆周](/img/angle002.jpg)
![正十二面体-正十二面体：200个圆周](/img/angle003.jpg)
![正方体-正方体：18个圆周](/img/angle004.jpg)
![正四面体-正方体 / 正四面体-正四面体：32个圆周](/img/angle005.jpg)