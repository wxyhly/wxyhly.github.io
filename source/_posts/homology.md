---
title: 代数拓扑简介（下）：同调论
tags:
  - 群论
  - 拓扑学
  - 图形
  - 数学
date: 2022-12-18 12:00:37
---

 
<p class="likecode"> /// 注：本文仅提供对同调相关概念的直观理解，不包含严谨的推导内容，文中若有错误欢迎指正。</p>

[上篇文章](/archives/homotopy/)说了同伦群（Homotopy Group）,这次我们来看看同调群（Homology Group）。同调要稍微抽象一些，但其实某种程度上要比同伦简单。回到最初通过路径判断孔的思路中来，同伦研究的是圆圈连续收缩的过程，虽然直接但难以计算。仔细观察不难发现，那些可缩成一点的图形的内部都是一块封闭的区域。如果假设只要一个封闭路径是图形中某块区域的边界，则认为它没有套住或跨越任何孔洞，我们把这样的圈叫做是“零调”的。注意这里零调的路径虽然跟同伦里的可缩路径很像，但零调的路径可能不一定真的可缩，后面我们将看到同调的条件要弱于同伦。比如下图左图青色区域的边界包含孔的边界和红色圈，单独的红色圈不是任何图形的边界，因此可知它包住了孔，而右图中的红色圈是蓝色区域的边界，因此它不包含任何孔，是“零调”的。![左图中的包住了孔红色圈与右图可缩（“零调”）的红色圈（是蓝色区域的边界）](/img/homology007.svg)
<!--more-->如果某个封闭图形的边界恰为两条路径之差（和差与方向有关，后面再解释），我们说两条路径是“同调”的——因为它们相差了0——一个封闭图形的边界。比如下图左图中的两个红色圈恰好构成黄色二维区域的边界，所以它们同调；然而右图两个红色圈并不是黄色区域的边界，因为黄色区域边界由三部分组成，还差一个孔的边界，说明这两个红色圈跨越过了一个孔，不同调。
![左图为同调的两个红色圈（它们是黄色区域的边界）；右图为不同调的两个红色圈](/img/homology032.svg)
仿照同伦群，我们已经大概了解了同调等价的路径，要得到同调群则需要再定义它们之间的复合运算。首先思考一下同调等价的路径应该怎样具体定义。注意路径是有方向的，这里最重要的就是要小心处理好封闭区域跟边界上方向的联系。下面定义“链”的概念，它是带方向路径的$n$维推广。
### 链与链群
不严格地说，$n$维链的定义是把空间中任何$n$维子图形映射到整数的映射，这个整数可以理解为图形叠加的次数，且$n$维子图形带方向，反向后叠加次数也要反号。直观上看，$n$维链其实就是在描述带方向的可叠加的$n$维子图形。既然都在叠加了，链之间的加法自然就是把各自的叠加重数相加。注意重数可正可负，方向相同则会累加，相反则抵消，下图分别是一些一维链之间，二维链之间的加法，注意跨维度的链之间无法相加。这些$n$维链及其之间的加法形成的代数结构叫做$n$维链群。注意链之间的加法本质上是叠加的整数相加，当然满足交换律，因此链群与后面我们将定义的同调群都是交换群。
![上图：红色+蓝色（左）== 灰色（右），下图为ABC三个2维链相加，方向通过漩涡表示](/img/homology008.svg)
定义了链与加法(链群)后，怎样描述孔洞呢？我们需要通过某种方式判断这条$n$维链是否是某个$n+1$维链的边界，如果不是则找到了一个洞。注意任何图形的边界一定是闭合的，即任何图形的边界不再有边界。跟研究同伦群一样，我们也只研究封闭的链，因为那些不封闭的链自然不可能是高维图形的边界。注意链是有方向、有叠加重数的，所以链的边界也一样会保留方向与叠加重数，即n+1维链求边界后得到$n$维链，（本文不考虑不光滑的分形那些极端情况）读者看到这里可能会有点发晕，下面就来看看各维度的例子。

零维是一个点，它可能是一维图形的边界(端点)。按照同调的定义，两个零维点要想同调的话，它们之间的差得是某1维链的边界(端点)，换句话说只要存在一条道路将它们连起来就行。注意链是带方向的，点（零维链）与一条线段（一维链）也有方向性。零维链像标量，代表着点的重数（即好几个点叠加到一块）。一维链有点像向量：线段$ab$与线段$ba$是相反的，它们相加会抵消。我们可以记做$ab=-ba$。
![](/img/homology009.svg)
引入一个边缘算子记号$\partial$代表取一个链的边界，我们规定始端为正，末端为负，即$\partial (ab) = a - b$。为什么后面端点要给成负数呢？因为我们希望取边界运算与链的加法之间顺序是可交换的：三角形$abc$的边缘是一个没有边界的封闭的一维图形，它由三条链组成$ab+bc+ca$。我们求它的边缘，则有$(a-b) + (b-c) + (c-a) =0$，跟预期相符合。这样规定还有一个原因：之前说希望两个点之间的差是某个链的边缘链，那么$a-b$自然是一维链$ab$的边界，所以零维链$a-b$是一条零链，可以在同调的意义下写成$a-b=0$，因此$a=b$（点$a$与点$b$同调等价）。
下面我们来做一些计算边缘链的小练习来看看二维链又是啥。
1. 计算下图阴影区域二维链的边缘链，这条链的方向已经标注出来了。
![](/img/homology010.svg)
我们还是按三角形的顺序来记录链的方向。于是要求的边缘链为$$\partial (ade+aeb)=\partial(ade) + \partial(aeb) = (ad + de + ea) + (ae + eb + ba)$$注意$ea = -ae$，所以有$\partial (ade+aeb)= ad + de + eb + ba$，边缘为下图所示。
![](/img/homology011.svg)
任何图形的边界都是封闭的，换句话说边缘的边缘一定是0，即对任何链$A$都有$\partial\partial A=0$，读者可以自行验证上图红色的链确实边界为0。
2. 下面这个二维链的边缘链又是什么呢？读者可以自己计算一下，答案放在下一个小结说。
![](/img/homology012.svg)

### 闭链群与边缘链群
现在熟悉了任意链与链之间的加法运算和求边界链的运算，下一步我们就要缩小范围只关注那些有可能拴住孔洞的闭合的链，即满足$\partial A = 0$的链$A$，称这些没有边缘的链为**闭链**。规定零维的点没有边缘，所以零维链都是闭链。之前还说过，如果一条链是某块图形的边缘，我们照样认为它没拴住孔，即对于链$A$存在链$B$使得$\partial B = A$，我们把这种是某个链$B$边缘的链$A$叫做**边缘链**。为什么这一节的小标题要叫闭链群与边缘链群呢？因为可以验证闭链+闭链=闭链，边缘链+边缘链=边缘链，两种链都各自对加法运算封闭，所以都是群。又由于每个图形的边缘都是闭合图形，因此所有边缘链都是闭链，所以有下面的群包含关系：边缘链群 $\subset$ 闭链群 $\subset$ 链群。
下面的图中给了一些例子：左边青色圈与黑色圈都是闭链，也是边缘链（青色是$acd+dea$的边界，黑色是$feb$的边界），而紫色圈是闭链，但不是边缘链（它套住了孔$fed$）；右图有蓝、红两条一维链和一条绿色二维链，它们都不是闭链。注意虽然蓝色链形状闭合，但方向不一致，可以算出它的边缘链是$2e-2a$。
![边缘链、非边缘的闭链、非闭链具体例子](/img/homology018.svg)
### 同调类与同调群
有了以上铺垫，同调类自然就能定义了。把那些相差了一个边缘链两条闭链视为相同的，形成一个等价类，我们称之为**同调类**，可以验证这些等价类之间的加法也是定义良好的，我们称同调类之间的加法运算形成**同调群**。如果读者了解群同构第一基本定理的话不难看出，同调群是将闭链群中的边缘链映射到0得到的商群。
概念不多，但说得有些抽象，下面多看一些例子慢慢体会。

1. 之前说，在同一个连通分支内的各个重数一样的单点都是同调的，要对所有的零维链按照同调等价类分类，只需要统计每个连通分支中点的总数目（重数）即可。比如一个有三个连通分支的图形的每个分支中所有点等价，我们就可以合并同类项，所有零维链肯定能写成$ax+by+cz$的形式，这些零维同调链连同加法运算就叫零维同调群，它们之间的加法也就是$x,y,z$前面的系数对应相加，这跟三维空间中的整数($\mathbb{Z}$)坐标点之间的加法一样，我们记作$\mathbb{Z}^3$。我们不难拓展到任意有$i$各连通分支的拓扑空间，它的零维同调群是$\mathbb{Z}^i$，即同构于$i$维空间整数坐标的加法群。
![一条零维链，每个点的重数以数字形式标出，这条链同调于$-x+y+4z$](/img/homology013.svg)
这里提醒一下链群与同调群之间的关系：链群是单纯的所有链之间的加法运算，不管是不是闭合的图形统统都在里面，且图形改变后各个链也会变化；而同调群是闭链群中构造的同调等价类之间的加法运算，它反映图形的拓扑信息。试想如果直接在零维链群上定义加法，那么图形中有多少个点就有多少自由度，这个数量就太多了，对数连通分支个数完全没帮助。
2. 下面来看一维链的情况。为了方便计算边缘链，我们把下面左图的图形做三角剖分为右图。这样通过三角剖分计算的同调群，称为**单纯同调**，因为三角剖分继续推广到三维是四面体，四维是五胞体，它们统称$n$维单纯形。单纯同调的好处是，它可以很清晰地把高维图形的方向说清楚。
![空心圆盘的一个三角剖分](/img/homology014.svg)
首先要找到所有的闭链。不妨直接硬算：列举出所有的链，图形有十二条边，链就有十二个自由度，这里设了十二个变量$x\_1$至$x\_{12}$，令它的边缘链为0，可以得到一个方程：
$\partial (x_1 ab+x_2 bc+x_3 ca+ x_4 de$ $ + x_5 ef + x_6 fd+ x_7 ad + x_8 be$ $ + x\_9 cf + x\_{10}ae + x\_{11}bf+x\_{12}cd)$
$=(x_1-x_3+x\_7+x\_{10})a$ $+(x_2-x_1+x\_8+x\_{11})b$ $+(x_3-x_2+x\_9+x\_{12})c$ $+(x_4-x_6-x\_7-x\_{12})d$ $+(x_5-x_4-x\_8-x\_{10})e$ $+(x_6-x_5-x\_9-x\_{11})f=0$
没有边界意味着以上合并同类项后的每项系数均为零，即闭链的系数需要满足下面方程组：
$$\begin{cases}
x\_1-x\_3+x\_7+x\_{10} = 0 \\\\
x\_2-x\_1+x\_8+x\_{11} = 0 \\\\
x\_3-x\_2+x\_9+x\_{12} = 0 \\\\
x\_4-x\_6-x\_7-x\_{12} = 0 \\\\
x\_5-x\_4-x\_8-x\_{10} = 0 \\\\
x\_6-x\_5-x\_9-x\_{11} = 0
\end{cases}$$
十二个变量六个方程，看似闭链还剩6个自由度，但学过线性代数的话不难验证这个方程的系数矩阵的秩为5，即有一个冗余的方程，闭链其实还有7个自由度。所有的闭链都可以由以下7个闭链叠加“生成”得到。
我们继续看看边缘链：所有的二维链都由六块边缘不同的三角形组成，自然边缘链的自由度为6。
下图中画出了闭链、边缘链的“生成元”：其它的闭链、边缘链可以由它们通过加法与数乘运算组合出来，比如这里画出的所有的链都是顺时针的，而逆时针可以由顺时针乘以-1得到。我们再看看同7个闭链中有六个都是边缘链它们都同调于0链，只有剩下一个不是，因此一阶同调群为剩下这个圈生成的加法群，即自己跟自己叠加，只有一个自由度，同构于整数加法群$Z$，我们看到空心圆盘的同调群跟同伦基本群是一样的。
![左图：所有闭链的7个“基”；右图：所有边缘链的6个“基”](/img/homology015.svg)
现在我们再来看看前面思考题要求的边缘链：直观上看内外两圈道路如果方向相反它们是可以扫过环状的实心区域形变收缩然后对消，但单独一个圈却不是任何图形的边界，永远也消不掉。
![上小节思考题答案：阴影区域二维链的边缘链为两个方向相反的红色圈](/img/homology016.svg)
从这个例子不难看出，给一个只要能三角剖分的很复杂的拓扑空间，都可以把一个连续的几何问题变成离散的代数问题，具体则是线性代数跟矩阵秩相关的算法，可以交给计算机处理，因此理论上任何空间的同调群的计算都没有任何技术困难。
3. 再来看看球面的同调群，它是连通的，只有一个连通分支，因此零维同调群为$\mathbb{Z}$，它上面的所有圈都是可缩的，自然也找不到不同调于0的一维链，这表明球面没有任何一维孔，一维同调群为0。球面有二维孔吗？整个球面其实就是唯一的封闭2维面，它很明显是三维实心球体的边界，但这里我们考虑的只是二维球面本身，不存在任何3维的图形，那么它自然就不是边缘链，因此球面的二维同调群就是整个球面叠加生成的，只有一个自由度，因此也是$\mathbb{Z}$。这里我们发现，拓扑空间的各阶同调群往往都跟$n$维空间中的整数坐标的加法群一样，这些空间的维度就是同调群的自由度，这样也就抓住了孔的个数。比如球面的各阶同调群分别为$\mathbb{Z},0,\mathbb{Z}$，则说明它有一个连通分支，没有一维洞，还一个球面形的二维洞。我们将这些$i$维同调群的自由度记作拓扑空间的Betti数$b_i$，对于球面有$b_0=1, b_1=0, b_2=1$，它反映了各维度的洞的个数。
4. 计算环面的同调群。整个环面是连通的，所以$b_0=1$。要求$b_1$的话我们着重关注这些经纬线，看看它们是否是某二维图形的边界。沿经线切开，剩下图形的边界是两个圆圈，要保证方向一致的话，它们的方向必须相反。当两个圆周粘回去时，恰好抵消，得到没边界的整个曲面，也就是说单独的经线确实不是任何二维图形的边界，它就是我们要找的一个非零调的链。同理纬线圈也一样，算上这些圈的组合，可以证明所有的同调链都能写成$a$经线$+b$纬线的形式，它们之间的加法运算跟二维向量之间的加法是一样的，一共有两个自由度，说明圆环有两个一维孔，Betti数$b_1=2$。最后跟球相似，圆环面本身有个中空的实心环孔结构，由于我们没有考虑圆环内部的三维空间，所以整个二维环面只是一层套在环孔上的“壳”，它不是零调的。故$b_2=1$。因此圆环面所有同调群的维数（即Betti数）分别为：$b_0=1, b_1=2, b_2=1$。
![经线不是边缘链，纬线同理](/img/homology003.jpg)
5. 圆环内部的三维实心区域的同调群又是什么样的呢？首先这个二维环面现在已是实心圆环体空间的边界，因此它是零调的，没有二维孔，即$b_2=0$;其次，圆环上的经线圈现在也是可缩的了，沿经线圈把环体砍开得到的截面的边界就是经线本身，说明经线是同调于0的边缘链，但纬线仍然不可缩，只剩一个自由度，所以$b_1=1$。它还是一个连通图形，故$b_0=1$。总结一下圆环内部的三维实心区域的Betti数分别为：$b_0=1, b_1=1, b_2=0$。我们可以看到，圆周是它的形变收缩核，实心圆环与一维的圆周同伦，所以它的各阶同调群跟一维的圆周是等价的。
6. “8”字形的同调群：图形连通，$b_0=1$；分别绕两个圈的链都不是边界链，一维同调群为$\mathbb{Z}^2$，$b_0=2$。注意之前计算过“8”字形和环面的同伦基本群，它们分别是自由群$\mathbb{Z}*\mathbb{Z}$和交换群$\mathbb{Z}^2$。由于同调群的可交换性，它们之前的区别被抹杀掉了。可以证明任意拓扑空间的同伦基本群添加交换律后就能得到它的一阶同调群。
6. 超立方体的零维骨架：16个孤立的顶点：$b_0=16$，大于等于1的Betti数均为0。
7. 超立方体的一维骨架：32条棱构成的一张连通的网，显然$b_0=1$。我们可以通过同伦变换把立体的超立方体的洞给数出来共17个，即$b_1=17$：
![压缩掉一维立体骨架中一个方向的棱变成平面图方便数孔，注意中途不要把洞给缩没了](/img/homology004.jpg)
![在平面图上清晰地看到一有共17个独立孔](/img/homology017.svg)
其实还有个巧妙的方法计算任意图（Graph）的一维环孔数$b_1$。我们先随便构造一颗树，即没有环路的的图来覆盖所有顶点，其它没被树覆盖的边的数量就是一维环孔的数量。因为没环路的树是可缩成一点的，这样其它没被树覆盖的边就变成了圆周，整个图形就是那些圆周的单点并。
![超立方体有$32$条棱，这颗生成树的边数为$15$，环孔树为$32-15=17$](/img/homology101.png)
8. 超立方体的二维骨架：24个正方形面把三维空间分成了互不连通7块胞腔。注意我们数超立方体的八个胞腔还要数最外面的大立方体胞，但同调的意义下一个包住大立方体胞的二维链可以由分别包住里面七个胞腔的七条二维链相加得到，所以独立的二维孔洞只有7个，即$b_2=7$。这个图形与实心立方体内有七个气泡的图形同伦，气泡无法拴住一维的圈，即所有一维的闭路径可缩，因此有$b_0=1,b_1=0,b_2=7$。
8. $n$维球面$S^n$上小于$n$维的球面都是可缩的，因此有 $b\_0=1, b\_1=b\_2=..b\_{n-1}=0, b\_n=1$。
9. 根据同伦一定同调，$n$维空间$\mathbb{R}^n$、实心球$D^n$均与单点同伦，所以Betti数为$b_0=1, b_1=b_2=..b_n=0$。
9. 有时候同调群并不能区分不同伦的图形。比如以下左边图形（两圆周和一个球面的单点并）跟右边环面，它们都是1个连通分支、2个一维孔、一个二维孔，$b_0=1, b_1=2, b_2=1$。后面我们将用新的上同调论来区分它们。
![](/img/homology031.svg)
9. 下面我们来看看球环与环球的同调群：球环的纬线圈不可缩，与纬线垂直的是经球面，所有的经线都能在经球面上缩成一点，但二维的经球面本身不可缩，于是有$b\_0=1, b\_1=1, b\_2=1, b\_3=1$。其实环球与球环同胚，它们互相互换经纬线，即环球的有一维的不可缩经线圈与二维球面形的不可缩纬面，因此同调群一样。


### 直积图形的同调群
还记得《[四维空间（五）：更多几何体[上]](/archives/more4ds/)》中提到过的直积形吗？类似圆环，球环与环球虽然不是几何上严格的直积形，但从拓扑上来说是，这样通过直积构造新的拓扑空间叫**积空间**。积空间$A=B\times C$的各维Betti数完全由$B$与$C$决定，它跟多项式相乘后的系数变化规律相同，比如圆环是两个圆周的直积，圆周的Betti数为$b\_0=1,b\_1=1$，将Betti数当成系数构造一个多项式$1+x$，则圆环Betti数对应的多项式为$(1+x)(1+x) = 1+2x+x^2$，提取系数得到$b_0=1, b\_1=2, b\_2=1$。为什么呢？不严谨地说就是把两个图形之间整个做直积后，面的同调链之间也做了直积，$m$维链乘$n$维得到链$m+n$维链，最后把各维的数量加起来，这个过程自然跟多项式乘法先做分配率再合并同类项一样。我们可以再验证一下环球（球环），它是圆周( $b\_0=1, b\_1=1$，对应多项式$1+x$)与球面($b\_0=1, b\_1=0, b\_2=1$，对应多项式$1+x^2$)的直积：$(1+x^2)(1+x) = 1+x+x^2+x^3$，系数对应下来得到$b\_0=1, b\_1=1, b\_2=1, b\_3=1$。有了这个定理我们可以快速计算出圆环环、双圆环的各阶Betti数，因为它们都同胚于三个圆周的直积，因为$(1+x)^3=1+3x+3x^2+x^3$，所以各阶Betti数分别为$b\_0=1, b\_1=3, b\_2=3, b\_3=1$。
### 欧拉公式的推广：欧拉-庞加莱公式
大家应该比较熟知多面体的欧拉定理：$V-E+F=2$。与其说这是一个关于多面体的定理，还不如说这是关于球面上某张图的定理。如果不是球体而是有$g$个孔的图形欧拉公式会变化吗？答案是欧拉公式变成了$V-E+F=2-2g=\chi$。等式右边的数字就是欧拉示性数$\chi$。推广到$n$维，则是$k$维“面”数$C_k$的交错和：$\chi=C_0-C_1+C_2-C_3+....C_n$。欧拉-庞加莱公式说，欧拉示性数$\chi$是一个拓扑不变量，它等于拓扑空间的各维Betti数的交错和，即
$\chi=C_0-C_1+C_2-C_3+....C_n$$=b_0-b_1+b_2-b_3+....b_n$。

这个公式看似证明很难，但$k$维“面”数$C_k$、各维Betti数其实都是一些群的自由度，我们只要理清它们之间的关系就好。对于三角剖分来说，顶点$C_0$的数目正是三角剖分上的所有零维链群的自由度，同理边的数目$C_1$是一维链群的自由度，面的数目$C_2$是二维链群的自由度。我们再看看同调群的自由度是怎么来的：同调群是在所有的闭链群中，将边缘链视为等价类后剩下的商群，记$i$维边缘链群自由度为$B\_i$，$i$维闭链群自由度为$Z\_i$，则有$z\_i=b_i+B\_i$。闭链群与一般链群之间是什么关系呢？如果我们将封闭的链视为“0”，构造一种新的等价类，那么在这个等价类意义下非零的链都是不封闭(即有边界的)的图形，且拥有相同边界的两条链相差一个封闭链，所以有多少不同的边缘链就有多少个等价类，即$C\_i=B\_{i-1}+Z\_i$，两式合并一下有$C\_i=b\_i+B\_{i-1}+B\_i$。把这些东西全都代入到要证的等式左边，注意所有0维链都是闭链，即第一项$C\_0=Z\_0=b\_0+B\_0$有：
$C\_0-C\_1+C\_2-....=$$(b\_0+B\_0)-(b\_1+B\_0+B\_1)+(b\_2+B\_1+B\_2)-....$
不难右边发现$B\_i$全都消掉了，只剩Betti数的交错和，欧拉-庞加莱公式得证。通过Betti数我们可以在不构造具体剖分的情况下直接计算各种拓扑空间的欧拉示性数$\chi$。

### 不可定向（单侧）曲面的同调群
我们来看看莫比乌斯带、克莱因瓶、射影平面等不可定向的单面曲面的各个同调群会不会有什么特殊的地方。莫比乌斯带其实跟圆周是同伦等价的，所以并没有什么研究价值。克莱因瓶是一个矩形一条对边直接粘上，另一条对边像莫比乌斯带一样扭转180度粘上的封闭曲面。这里用箭头来标注矩形各对边的粘合方式。整个图形是连通的，显然它的零阶同调群维数$b_0=1$，对于一阶同调群我们有这些候选的非边缘链：红色蓝色路径应该都不是任何图形的边界，因为感觉它们是不可缩的，但直接证明还没什么思路。
![注意边界上顶点和边都是重复的，因为对边粘起来后它们是同一个点、同一条边](/img/homology019.svg)
我们先把一维同调群放一放，看看克莱因瓶的二维同调群是什么。首先必须找到二维的闭链。但由于克莱因瓶不可定向，无法在整个曲面上覆盖定向完全一致的三角形，找不到任何的二维闭链，这将导致它的二维同调群阶数为0。不信我们可以试试：
1. 如果我们强行在矩形内画出定向一致的二维链，则矩形的边缘无法抵消，反而会变成两倍，所以这个二维链有边界，不是闭链。
![注意这里通过覆盖空间把边矩阵边缘对应关系“摊开”，目地是为了便于观察矩形边缘到底发生了什么](/img/homology021.svg)
2. 如果我们从下图左上角的那个三角形出发往右走逐渐添加相同定向的三角形，注意越过矩形边缘时根据矩形两边的连接关系定向会反向，最后我们得到的二维链还是有边界的。
![](/img/homology020.svg)

再回到一维同调群中来。我们发现下图中这条两条双重链（左图棕色和右图蓝色）都是边界链：当我们缝合曲面时，对于一般的定向曲面，两个圆周方向相反，重合后自然抵消，形成一个没有边界的图形，而现在由于两边定向相反，边界不但没有随着缝合消失而是翻倍，这就说明两倍的蓝色圆周确实与0同调！右图中单倍蓝色圆周显然确实不是任何图形的边界，蓝色同调链的加法运算就很特别了：就像奇数加奇数等于偶数一样，偶数个蓝色同调链相加等于0，奇数个相加则等于单圈蓝色同调链。我们的同调群结构不再跟整数加法一样了，变成了二阶循环群$C_2=\mathbb{Z}/2\mathbb{Z}$，这里都是定向在捣鬼！

左图中的暗黄色链跟蓝色链情况是一样的，其实它们是同调的，因为它们之间相差了一块闭合区域$abchgc$(请读者自行验证)。事实上，暗黄圈与蓝圈都是克莱因瓶上的经线，这些经线可以自由地滑动，它们都同伦等价。
![](/img/homology022.svg)
然而纬线的情况是不同的。由于左右两边必须扭转粘合，因此平行于矩形边的纬线仅有两根。两周纬线会不会是某二维链边界就变成0了吗？其实并不是，我们试着沿纬线剪开，克莱因瓶将变成一个莫比乌斯环，这个不可定向图形上不可能找到只有以莫比乌斯环的边界为边缘链的二维链。所以综合来看，克莱因瓶的一阶同调群有两个部分组成，一个是无限的整数加法群，一个是有限的整数模2加法群，整个群为$\mathbb{Z}\times\mathbb{Z}/2\mathbb{Z}$。我们说克莱因瓶除了有一维Betti数$b_1=1$，还有个一维挠系数2。

## 上同调论(Cohomology)

关于同调的例子就先暂时举这么多，下面来看一个新概念：上同调。同调链之间可以相加，能不能进一步在链之间定义乘法呢？直接似乎是没办法定义的，但可以通过代数上一种“对偶”的手段来定义。我们知道，数字之间肯定是可以相乘的。为了好区别，这里把之前我们说的链称为**下链**，定义一种与下链对偶的“**上链**”，它是将一般的下链映射成数字的映射，这样或许会方便在上链之间定义乘法结构。如果读者没接触过对偶向量空间的话可能略显得抽象，形象地说，$n$维上链是一台吃进一条$n$维下链就吐出一个数字的机器。不同的上链就是一部部不同的机器。看看具体的例子就清楚了：下图是一条上链，它正在把红色蓝色两条下链分别映射成两个数字。
![注意：负数代表方向相反，故图中未再标注方向](/img/homology012.png)
所有灰色数字代表一条一维上链：任给一条一维下链它都能将其映射成一个数，具体就是把相同位置上的数字乘上下链的重数，如它把上图的红下链映射到$1\times 1+1\times (-1)+1\times (-2)+1\times (-2)+1\times 2+1\times 2=0$，蓝下链映射到$1\times 1+1\times 1+1\times 0+1\times 0+1\times 0=2$。
两个下链之间的映射关系能不能对应到上链中来呢？这样或许就可以把下链中的闭链，边缘链等概念直接搬过来。答案是可以的。设映射$f$把$m$维的下链$a$映射到$n$维下链$b$，若有一条$n$维上链$b'$，它可以把$n$维下链$b$映射成数字，因为$b'(f(a)) = b'(b)=一个数$，我们发现$b'(f(x))$可以把$m$维的下链$x$映射成数字，所以这其实是一条$m$维上链，记作$a'$，换句话说，我们自然从下链的映射$f$诱导出了一个上链之间的映射$f'$，$f'$定义为$f'(b')=a'$，有$f'(b')(x)=a(x)=b'(f(x))$。这里一定要注意诱导出的映射方向是反的:$f$是从$a$到$b$，$f'$是从$b'$到$a'$。这是原空间和对偶空间之间普遍存在的规律。这些东西确实有点绕，可以参考我对向量空间与对偶空间的形象化想象——《[参观无限大养猪场](/archives/infpigfarm/)》（提示：这只是个脑洞，可能看了更晕）。
### 上边缘算子
边缘算子$\partial$将$n$维下链映射到$n-1$维下链，则对应到上链中可以定义上边缘算子，它把$n-1$维上链映射到$n$维。如果您读到这里还是对这些对偶空间的概念很晕，看看这个例子应该就能够理解：求解下面被三角剖分的环形图形上用灰色数字与箭头标注的这条一维上链的上边缘链。根据刚才所分析的，它的上边缘链应该是一条二维上链，二维面的方向已经用箭头表示出，因此我们的任务就是要求出每个二维面上的数字。
![所有灰色数字代表一条一维上链](/img/homology025.svg)
例如要求上图左下红色的$ade$三角形上的数字，应该怎么计算呢？上边缘的映射方向相对于下链是反的，因此我们可以构造一条下链$ade$，它的边界是$\partial(ade) = ad+de+ea$，这个二维的上边缘链将把下链$ade$映射到的数字跟原一维上链映射它的边缘链得到的数字相同，即$1+4-6=-1$。注意出现负号是因为方向相反。同理，其余的二维面上的数字也可以这样使用边界上数字的代数和得到，比如面$acd$中填入数字$-2$的原因是$2-3-1=-2$。
有了上链与上边缘算子的概念，接下来我们将定义上闭链与上边缘链。
### 上闭链
上闭链要求$n$维的上链的上边界(是$n+1$维的哦)为0，例如下图的灰色一维上链就是一条上闭链——它的上边缘是一条处处为0的二维上链（即把任何二维下链都映射为0）。
![](/img/homology026.svg)
从上图我们可以发现，上边缘要为0，则每一个圈上的数字代数和必须为0，即上闭链把那些是边缘链的下链（即这些一维下链是某二维下链的边缘）都映射至0。注意中间的def是一个中空的洞，上面没有二维链，一维下链$de+ef+fd$只是闭链，不是边缘链，因此不需要要求上闭链把它映射到0。

虽然直观上是这样，怎样证明这个结论呢？因为如果下链是边缘链且映射不为$0$，根据上边缘与下边缘映射关系的定义，$n$维上链的上边缘就会把下边缘链的内部图形映射到这个同样的非零值，矛盾; 如果下链不是边缘链，自然找不到这条链的“内部”，结果就是$n+1$维什么链都没有，自然就等于$0$了，于是对非边缘链没有什么限制。

### 上边缘链
上边缘链要求$n$维的上链是某个$n-1$维上链的边缘，同样我们还是把这种抽象话语用具体例子来翻译一下：下图中灰色一维上链是一条上边缘链，因为它是红色零维上链的上边缘。
![](/img/homology027.svg)
  给定一条$n$维上链，怎么判断它是否为上边缘链呢？或许我们能够把那个$n-1$维上链找出来：还是以刚才上图中的一维上链为例：设零维链在顶点$a$处的值为$x$，又因为$\partial (ad) = a-d$，且$ad$上标的数字为$1$，所以我们能够得到零维链在顶点$d$处的值为$x-1$，这样通过一条边一条边的计算最终我们就能构造出0维上链在所有顶点上的值。然而，如果通过不同路径推出零维上链在同一点的值不一样的话就矛盾了，这时我们就找不到符合要求的零维上链，从而该一维上链就不是上边缘链。我们发现一条一维的上链是不是上边缘链的关键在于它是否存在一种“路径无关性”，这种路径无关性可以等价于同起点同终点的两条不闭合的下链之差要被上链映射到0，这些下链一定是闭合的，因此上边缘链一定要把所有闭合的下链映射为0来保证路径无关性。怎样证明这个结论呢？$n$维的闭合下链是没有边缘的，如果$n$维上链不将它映射为$0$，$n-1$维上链会把闭合下链的边缘映射到这个非零值，这跟闭合下链没有边缘是矛盾的。

### 上同调
仿造下同调链，我们通过上闭链与上边缘链构造上同调的等价类从而构造上同调群。上闭链把所有下边缘链映射到零，上边缘链把所有下闭链映射到零，注意下边缘链一定是下闭链，所以上边缘链把所有下闭链映射到零也就“顺便”把所有下边缘链映射到了零，因此上边缘链一定是上闭链，即上边缘链是上闭链中的一个子群。如果两个上闭链相差了一个上边缘链，我们说两个上闭链是上同调的。具体来看看这个例子:
![左图上链与右图上链b之间相差一个把所有闭下链都映射到零的上链（下图），所以它们上同调](/img/homology028.svg)
通过例子不难发现，上面两个上同调的上链都会把只要下同调于$df+fe+ed$的下链都映射至-1，即跨越了中空的$dfe$孔洞的那些下链，因此上同调群也能反映图形孔洞的信息，这也反映了上同调群与下同调群之间有着巧妙的同构关系。这里每个上同调类就是把跨越了中间孔的下链都映射到不同的数字，它们之间的加法运算同构于整数加法群$\mathbb{Z}$，可想而知，如果图形有两个孔、三个孔，就是$\mathbb{Z}^2$、$\mathbb{Z}^3$……
其实到了这里，我们可以用更形象的东西来解开上同调的神秘面纱: 不难看出，那些上闭链一般都是遍布整个图形，且能把下链映射到数字的映射跟向量场特别像，给定一个下链，向量场(上链)在这条下链上通过的“流量”就是一个数字。上闭链是局部没有任何漩涡的向量场，想象一个电荷在电场中沿着下边缘链运动一圈回到原点，整个过程做功为0，这样能够保证局部能量守恒，但如果电荷绕孔沿经线跑一圈能量却增加了，总体能量不守恒，这个场就不是上边缘链，上闭链要求总体都不能存在任何漩涡，这样对整个图形才能存在一个“势能场”，它保证整体的能量守恒。如果一个图形有孔，局部能量守恒并不能保证整体能量守恒，图形上的孔正是不守恒的漏洞所在！再比如高中我们学过通电导线的磁场，导线外区域的磁场是（局部）无旋的，但磁场绕着导线一周却有正比与电流的环流量。

刚才都在说一维上同调群，我们看看零维上同调群的情况如何：零维的上闭链把所有零维的下边缘链映射到零，要满足这个要求就必须每条线段两端点上标的数字一样才行（想想为什么），即同一个连通分支的顶点上标注的数字相同，又由于所有的零维下链都是闭合的，因此上边缘链只能是0链，即上同调群就直接同构于上闭链群，它同构于图形连通分支的个数。我们可以看到这个例子中各阶上同调群与下同调群之间是同构的。
### 德拉姆上同调简介
如果读者熟悉高等数学(不熟悉可直接跳过此段)，我们可以看看向量场的斯托克斯公式与上下边缘算子之间的关系，它可以回答上边缘映射对应到向量场中到底是什么。斯托克斯公式是在说，封闭路径在向量场中的积分等于向量场的旋度通过任意以该路径为边缘的曲面的积分，换成人话就是向量场在路径上的环流量等于向量的旋度场在通过环路的通量。这里的以路径为边缘的曲面正是一条下链，它的边缘链就是那条路径，自然向量场是一条上链，向量场的旋度场就是该上链的上边缘链，上边缘算子其实就是梯度旋度算子的$n$维推广——外导数算子！

我们来看几个电磁场中的例子：一般来说电场$E$存在电势$\phi$的条件是电场无旋，即由
$$\nabla E = 0$$
可推出存在电势$\phi$使得
$$\nabla \phi = E$$
然而这个结论很多时候不成立。之所以我们很多时候都能愉快使用那个结论是因为很多时候场分布的区域都是一块单连通的无孔洞的区域，它的一维上同调群是平凡的。现在我们知道，$\nabla E = 0$说明电场的“上边缘”为0，即它是一维上闭链。然而上闭链不一定是上边缘链，除非整个图形没有任何一维孔。我们来看一个环面上向量场的一维德拉姆上同调群的例子，下图中两个环面上的经线、纬线向量场均为局部无旋场，但整体上跟着箭头走一圈却有“净流量”，它们是一维德拉姆上同调群的生成元。这些电场肯定是不存在势场的。
![](/img/homology014.jpg)
比如下图中环面上斜着的场也是一个不上同调于0的局部无旋场，它是经线场与纬线场叠加得到。
![](/img/homology015.jpg)
由于经纬线场可以自由叠加组合，因此整个群为$\mathbb{R}^2$。注意之前的上同调我们仅考虑的整数系数，所以得到群为$\mathbb{Z}^2$，如果考虑实数系数的话就都是$\mathbb{R}^2$。

我们看到上同调、下同调的具体“实现”方法非常多，从直观的下链到抽象的上链映射，再到更抽象的向量场，它们的“样子”完全不同，但最后得到的同调群是相同的，这说明同调并不针对某种具体的实现，就像研究群那样不关心具体元素的意义，而是把“同调公理”抽象出来，用范畴论的语言描述，这里就不展开了。

其实在场论中，满足$\nabla E = 0$的场$E$叫闭（Closed）的，相当于上闭链，存在$\phi$使得$\nabla \phi = E$的场$E$叫恰当（Exact）的，其实也就相当于上边缘链，只是习惯的称呼不同。边缘的边缘都是闭合的（$\partial^2=0$）可对应推出上边缘的上边缘都是上闭合的，这条性质到了场论中根据不同维度变成了好几个版本：梯度的旋度为0，旋度的散度为0……对于高维的链，可以用高维的$n$-向量场（一般叫做微分形式场）来充当上链，通过上同调(即寻找局部没漩涡但总体环绕高维孔的场)能够发现高维的孔洞。
### 上同调环
最后我们说说怎样让两个上链相乘。如果读者读过《[四维空间（七）：N维的向量](/archives/bivector4ds/)》就知道，场中每点处的两个$m$-向量与$n$-向量通过外积可以得到$(m+n)$-向量，这样我们得到一个$(m+n)$-向量场，即$m+n$维上链。可以证明这个乘法在上同调类之间的定义也是良好的，这意味着上同调类之间不仅有加法还有乘法，这样同时定义了加法与乘法的代数结构叫环，因此上同调不仅是群，还是环，它比下同调群的结构更加丰富。
比如对于以下两个图形，它们的各阶Betti数一样（分别为$1,2,1$），各维度上同调群都是一样的，一维上同调群的两个生成元以红色、绿色标出。左图中两个圈是相离的，上面的上链相乘没有公共部分，相乘结果为0。而右图中经线场与纬线场相乘得到整个环面上的二维涡旋场，它是二维上链的一个基，因此左图与右图的上同调环结构不同，所以它们不同调，因此也就不同伦。
![左图：两个圆周与球面的单点并；右图：环面](/img/homology030.svg)

### 庞加莱对偶性

不知你有没有发现，很多图形的各阶Betti数有一种对称性，比如n维球面$S^n$是$1,0,0,...,0,1$，n维环面$T^n$是二项式$(1+x)^n$展开系数$C_n^{0},C_n^{1},..,C_n^{n-1},C_n^{n}$，都是对称的，我们称之为**庞加莱对偶性**（Poincaré Duality），但两圆周的单点并却是$1,2$、二维环形区域是$1,1,0$。这两组图形最大的区别就是n维球面、n维环面都是封闭的n维流形，流形其实就是超曲面的推广：它定义为局部同胚于平坦空间$\mathbb{R}^n$的拓扑空间——因为光滑曲面局部放大后都近似是平面。而两圆周的单点并的那一点上不再局部像直线（$\mathbb{R}$）、二维环形区域的边界处也不再像平面（$\mathbb{R}^2$），所以它们不再具有庞加莱对偶性。
为什么流形的Betti数就拥有对偶性呢？答案是流形上的剖分可以构造得到对偶剖分结构。如果读者熟悉对偶多面体、对偶多胞体的话就知道，通过选取所有面心（胞心）作为顶点可以构造得到新的对偶多面（胞）体，这个对偶恰好将原来的$i$维图形与$n-i$维图形对应。这启发我们对任意一个三角剖分，只要构造出了对偶剖分，就都可以建立从$i$维下链群$C^i$到$n-i$维上链群$C_{n-i}$的对应关系。为什么要把下链对应到上链呢？因为我们可以很方便地定义上链的上边缘，它跟下链的边缘运算是对应的：一个图形的下边缘就是围成它的面之和，而一个图形的上边缘则是所有的以它为面的图形之和，如下图所示，左图$x$作为二维上链的一部分，通过计算一维上链的上边缘得到$x=a+b+c+d+e$，右图$x$作为零维下链的一部分，通过计算一维下链的下边缘得到$x=a+b+c+d+e$。注意不同剖分方式不影响拓扑不变量，所以通过对偶剖分算出的同调群肯定与原先的一样，我们即可得出$i$维下链群$C^i$与$n-i$维上链群$C_{n-i}$同构，且由于两边的上下边缘算子也是对应的，所以这里其实还能推出上下同调群$H^i$与$H_{n-i}$也是同构的。又由于同阶上同调群与下同调群同构，所以经过两次群同构就最终得到了两个下链群$H^i$与$H^{n-i}$同构，这就解释了betti数对称性的来源。
![](/img/homology029.svg)
其实这里我们还没考虑到不可定向流形，它的挠系数可不是直接对偶过去的，具体细节请参考正规的代数拓扑教材。

## 题外话：庞加莱猜想与庞加莱同调球

说到代数拓扑，想必没有什么大众知道，但代数拓扑中的庞加莱猜想的知名度却很高。庞加莱的猜想很简单。由于一个可定向的n维连通的封闭拓扑空间n维同调群肯定为$\mathbb{Z}$，又因为连通性，0维同调群一定也是$\mathbb{Z}$，除此之外其它低维的同调群如果都是0，那么这就是一种最简单的没有孔的封闭图形。我们有必要相信这个n维空间是个n维球面，即庞加莱猜测跟球面有同样同调群的空间只有球面，但很快他找到了反例。庞加莱通过将正十二面体每个面与相对的面扭转1/10圈粘起来构造了一种“同调球”（由于正十二面体相对的正五边形刚好是反的，所以只能扭1/10、3/10、5/10圈才可能粘得上，分别得到庞加莱同调球、Seifert-Webe空间与实射影空间），它跟正常的三维球面同调但不同伦，自然也不同胚。

庞加莱没有因这个反例而放弃，他把猜想改为是不是只要一个封闭曲面上所有路径都可缩它就一定是球呢？答案是肯定的，这样限制后不再有反例，即任何一个单连通的，闭的$n$维流形一定同胚于一个$n$维的球面（$n\geq 2$）。数学家们先后证明了对高维球的庞加莱猜想，然而这个看似直观的结论在$n=3$时的证明却异常困难，最终等到2006年才被俄罗斯的一名数学家解决。神奇的是他的证明方法不仅解决了庞加莱的猜想，还顺便给所有的三维流形（可以理解为曲胞）做了分类。把所有的二维曲面按照某些度量的性质分成了球面，平面与双曲空间，而对三维空间的分类有八种！除了3种二维类比到三维的空间与2种直积空间外，还有3种各向异性的“怪空间”，在那里无限循环的悖论楼梯将变得可能...这又是来自几何拓扑的另一个精彩的故事了。

